(()=>{"use strict";let e,t=!1;function o(){return(Date.now()-e).toString().padStart(5,"0")}const n=["image/jpeg","image/png","image/gif","image/webp","image/heic","image/heif","image/avif","image/svg+xml","text/plain","application/pdf","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/vnd.rar"],i=wp_localize_bigup_contact_form_vars;let a=!1;async function l(l){l.preventDefault(),e=Date.now(),t&&console.log("Time | Start/Finish | Function | Target"),t&&console.log(o()+" |START| handleFormSubmit");const s=l.currentTarget,m=s.querySelector(".bigup__form_output");let f=["bigup__form-popout","bigup__alert"];""!=s.querySelector('[name="required_field"]').value&&(document.documentElement.remove(),window.location.replace("https://en.wikipedia.org/wiki/Robot"));const y=new FormData,g=s.querySelectorAll(".bigup__form_input"),h=s.querySelector(".bigup__customFileUpload_input");if(g.forEach((e=>{y.append(e.name,e.value)})),h){const e=h.files;for(let t=0;t<e.length;t++){let o=e[t];if(!n.includes(o.type)){const e=o.name.split(".").pop();return f=[...f,"bigup__alert-danger"],m.style.display="flex",await d(m,"opacity","0"),await c(m),await u(m,[`The selected file type ".${e}" is not allowed`],f),await d(m,"opacity","1"),await p(5e3),await d(m,"opacity","0"),await c(m),void(m.style.display="none")}y.append("files[]",o,o.name)}}const w=i.rest_url,_={method:"POST",headers:{"X-WP-Nonce":i.rest_nonce,Accept:"application/json"},body:y};try{a=!0,function(e){t&&console.log(`${o()} |START| lockForm | Locked`);const n=e.querySelectorAll(".bigup__form_section");n.forEach((e=>{e.classList.add("disabled")}));const i=e.querySelectorAll(":is( input, textarea )");i.forEach((e=>{e.disabled=!0}));const l=e.querySelector(".bigup__form_submit > *:first-child");let r=l.innerText;l.innerText="[Busy]";let s=setInterval((()=>{a||(clearInterval(s),n.forEach((e=>{e.classList.remove("disabled")})),i.forEach((e=>{e.disabled=!1})),l.innerText=r,t&&console.log(`${o()} | END | lockForm | Unlocked`))}),250)}(s),m.style.display="flex",await u(m,["Connecting..."],f);let[e]=await Promise.all([r(w,_),d(m,"opacity","1")]);e.class=e.ok?"success":"danger",f=[...f,"bigup__alert-"+e.class],await d(m,"opacity","0"),await c(m),await u(m,e.output,f),await d(m,"opacity","1"),await p(5e3),await d(m,"opacity","0"),await c(m),e.ok&&(s.querySelectorAll(".bigup__form_input").forEach((e=>{e.value=""})),c(s.querySelector(".bigup__customFileUpload_fileList"))),m.style.display="none",a=!1}catch(e){console.error(e)}finally{t&&console.log(o()+" | END | handleFormSubmit")}}async function r(e,n){try{t&&console.log(`${o()} |START| Fetch request`);const i=new AbortController,a=setTimeout((()=>i.abort()),14e3),l=await fetch(e,{...n,signal:i.signal});clearTimeout(a);const r=await l.json();if(r.ok=l.ok,"string"==typeof r.output&&(r.output=[r.output]),!r.ok)throw r;return r}catch(e){e.output||(e.output=["Failed to establish a connection to the server."],e.ok=!1,console.error(e));for(const t in e.output)console.error(s(e.output[t]));return e}finally{t&&console.log(`${o()} | END | Fetch request`)}}function s(e){return e.replace(/(?<!\([^)]*?)<[^>]*?>/g,"").match(/(\([^\)]*?\))|[ \p{L}\p{N}\p{M}\p{P}]/gu).join("").replace(/^\s*|\s(?=\s)|\s*$/g,"")}function c(e){return t&&console.log(`${o()} |START| removeChildren | ${e.classList}`),new Promise((n=>{try{for(;e.firstChild;)e.removeChild(e.firstChild);n("Child nodes removed successfully.")}catch(e){reject(e)}finally{t&&console.log(`${o()} | END | removeChildren | ${e.classList}`)}}))}function p(e){return new Promise((t=>{setTimeout((()=>{t("Pause completed successfully.")}),e)}))}function u(e,n,i){return t&&console.log(`${o()} |START| popoutsIntoDom | ${n[0]}`),new Promise(((a,l)=>{try{if(!e||e.nodeType!==Node.ELEMENT_NODE)throw new TypeError("parentElement must be an element node.");if(!f(n))throw new TypeError(`messageArray must be non-string iterable. ${typeof n} found.`);let t=[];n.forEach((o=>{let n=document.createElement("p");n.innerText=s(o),i.forEach((e=>{n.classList.add(e)})),e.appendChild(n),t.push(n)})),a(t)}catch(e){l(e)}finally{t&&console.log(`${o()} | END | popoutsIntoDom | ${n[0]}`)}}))}function m(e,n){return new Promise((i=>{try{t&&console.log(`${o()} |START| transition | ${this.classList} : ${e} : ${n}`),this.style[e]=n;let a=setInterval((()=>{getComputedStyle(this).opacity===n&&(clearInterval(a),t&&console.log(`${o()} | END | transition | ${this.classList} : ${e} : ${n}`),i("Transition complete."))}),10)}catch(e){reject(e)}}))}async function d(e,t,o){if(f(e)||(e=[e]),f(e)&&e.every((e=>1===e.nodeType))){const n=e.map((e=>m.bind(e)(t,o)));return await Promise.all(n)}throw new TypeError("elements must be a non-string iterable. "+typeof e+" found.")}function f(e){return null!=e&&"function"==typeof e[Symbol.iterator]}let y=setInterval((()=>{"complete"===document.readyState&&(clearInterval(y),document.querySelectorAll(".saveTheBees").forEach((e=>{"none"!==e.style.display&&(e.style.display="none")})),document.querySelectorAll(".bigup__form").forEach((e=>{e.addEventListener("submit",l),e.querySelector(".bigup__customFileUpload_input").addEventListener("change",g)})))}),250);const g=e=>{const t=e.currentTarget,o=t.parentElement.nextElementSibling,n=document.createElement("ul");c(o),o.appendChild(n);for(var i=0;i<t.files.length;++i)n.innerHTML+="<li>"+t.files.item(i).name+"</li>"}})();
//# sourceMappingURL=contact-form.js.map